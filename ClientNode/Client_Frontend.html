
<!DOCTYPE html>
<html>
<head>
    <title>Seed URL Submission</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <!-- <style>
        body { font-family: Arial; padding: 20px; max-width: 400px; margin: auto; }
        input, button { display: block; margin: 10px 0; width: 100%; padding: 10px; }
    </style> -->
</head>
<body>

<div class='bold-line'></div>
<div class='container1'>
  <div class='window'>
    <div class='overlay'></div>
    <div class='content1'>
      <div class='welcome'>Submit Seed URL</div>
      <div class='input-fields'>
      <input class='input-line full-width' type="text" id="url" placeholder="Seed URL" required>
    <input class='input-line full-width' type="number" id="depth" placeholder="Crawl Depth" required></div>
    <div><button class="ghost-round full-width" onclick="sendSeedToSQS()">Send</button></div>
    <p id="seedResponse"></p></div>

    <div class='content2'>
    <div class='welcome'>Submit Search Query</div>
            <!-- <div class='input-fields'></div>
            <input class='input-line full-width' type="text" id="keywords" placeholder="Search Keywords" required> -->

            <div class="search-box">
                <button class="btn-search" onclick="submitSearchAndDisplayResults()"><i class="fas fa-search" ></i></button>
                <input class='input-search' type="text" id="keywords" placeholder="Search Keywords" required></div>
            <!-- <div><button class="ghost-round full-width" onclick="submitSearchAndDisplayResults()">Search</button></div> -->
    <p id="searchResponse"></p>
    
    </div>
    </div>

      <!-- <div class='subtitle'>We're almost done. Before using our services you need to create an account.</div> -->
   
   
      <!-- <h2>Submit Seed URL</h2>
    <input type="text" id="url" placeholder="Seed URL" required>
    <input type="number" id="depth" placeholder="Crawl Depth" required>
    <button onclick="sendSeedToSQS()">Send</button> -->
    


<!-- 

    <div class='container2'>
        <div class='window'>
          <div class='overlay'></div>
          <div class='content'> -->
            
            <!-- </div>
            </div>
        </div> -->
    <!-- <h2>Submit Search Query</h2>
    <input type="text" id="keywords" placeholder="Search Keywords" required>
    <button onclick="submitSearchAndDisplayResults()">Search indexed keywords</button> -->



    <!-- <h2>Submit Search Query</h2>
    <input type="text" id="keywords" placeholder="Search Keywords" required>
    <button onclick="sendSearchToSQS()">Send Search Query</button>

    <button onclick="getSearchResults()">Get Search Results</button>

    <p id="searchResponse"></p> -->
    
<script>


async function sendSeedToSQS() {
    const url = document.getElementById('url').value;
    const depth = document.getElementById('depth').value;
    const resElem = document.getElementById('seedResponse');

    const payload = { url, depth };
    console.log('[Client] Preparing to send payload:', payload);

    try {
        const response = await fetch('http://54.88.141.236:5000/send', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(payload),
            mode: 'cors',
            cache: 'no-cache'
        });

        const raw = await response.text();
        console.log('[Client] Raw response text:', raw);

        try {
            const data = JSON.parse(raw);
            resElem.innerText = data.message || 'Success';
      } catch (parseError) {
            console.error('[Client] JSON parse error:', parseError);
            resElem.innerText = 'Invalid JSON from server: ' + parseError + '\n' + raw;
        }
    } catch (err) {
        console.error('[Client] Fetch/network error:', err);
        resElem.innerText = 'Network or CORS error: ' + err;
    }
}

async function submitSearchAndDisplayResults() {
    const keywords = document.getElementById('keywords').value;
    const resElem = document.getElementById('searchResponse');

    console.log('[Client] Preparing to send search keyword:', keywords);

    try {
        // Send 
        const sendResponse = await fetch('http://54.88.141.236:5000/send-search', {
            method: 'POST',
            headers: {
                'Content-Type': 'text/plain'
            },
            body: keywords,
            mode: 'cors',
            cache: 'no-cache'
        });

        const sendData = await sendResponse.json();
        console.log('[Client] Search query sent:', sendData.message || 'Search query sent successfully!');
        resElem.innerText = 'Search query sent. Waiting for results...';

        // fetch 
        const resultsResponse = await fetch('http://54.88.141.236:5000/get-search-results', {
            method: 'GET',
            mode: 'cors',
            cache: 'no-cache'
        });

        const resultsData = await resultsResponse.json();
        if (resultsData.results) {
            resElem.innerText = JSON.stringify(resultsData.results, null, 2);
        } else {
            resElem.innerText = resultsData.message || 'No results found.';
        }
    } catch (err) {
        console.error('[Client] Fetch/network error:', err);
        resElem.innerText = 'Network or CORS error: ' + err;
    }
}

document.getElementById('keywords').addEventListener('keydown', function (event) {
    if (event.key === 'Enter') {
        event.preventDefault(); // Prevent the default form submission behavior
        document.querySelector('.btn-search').click(); // Trigger the search button click
    }
});




</script>



    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.1370.0.min.js"></script>
</body>
</html>

